!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=307)}({307:function(e,t){var n={};function o(){document.getElementById("logger").innerHTML+="run\r",function(e){document.getElementById("logger").innerHTML+="fill\r";var t="pageId=53811457&f=meetingCollector&title01="+e.subject+"&beginTm="+e.start.format("dd.MM.yyyy HH:mm")+"&endTm="+e.end.format("dd.MM.yyyy HH:mm")+"&obligMember="+e.requiredAttendees.map((function(e){return e.emailAddress}))+"&optionalMember="+e.optionalAttendees.map((function(e){return e.emailAddress}))+"&place="+e.location+"&agenda="+e.body+"&type=OutlookConfluence&authorMeeting="+e.organizer.emailAddress;(function(e){document.getElementById("logger").innerHTML+="send message\r",$.ajax({url:"https://confluence.beeline.kz/ajax/confiforms/rest/save.action",type:"POST",headers:{Authorization:"Basic "+btoa("tech_outlook_mom:~F4B?#?Z")},contentType:"application/x-www-form-urlencoded;",data:e}).done((function(e){document.getElementById("logger").innerHTML+="send message done\r";try{var t=JSON.parse(e);document.getElementById("logger").innerHTML+=JSON.stringify(t)+"\r",n=t.id,document.getElementById("logger").innerHTML+="get item url: "+n+"\r",$.ajax({url:"https://confluence.beeline.kz/ajax/confiforms/rest/filter.action",type:"GET",headers:{Authorization:"Basic "+btoa("tech_outlook_mom:~F4B?#?Z")},contentType:"application/x-www-form-urlencoded;",data:"pageId=53811457&f=meetingCollector&q=id:"+n}).done((function(e){document.getElementById("logger").innerHTML+="get item url done\r";var t=e.list.entry[0].fields.meetingLink;window.open("https://confluence.beeline.kz/pages/viewpage.action?pageId="+t,"_blank")})).fail((function(e,t,n){document.getElementById("logger").innerHTML+=JSON.stringify(e)+"\r"}))}catch(e){return void(document.getElementById("logger").innerHTML+=e.message+"\r")}var n})).fail((function(e){document.getElementById("logger").innerHTML+="send message error: "+e+"\r"}))})(t),document.getElementById("logger").innerHTML+=t+"\r"}(n)}function r(e){$("#start").val(e.start.format("yyyy-MM-dd")),$("#end").text(e.end),$("#organizer").html(e.organizer.displayName),$("#location").html(e.location),$("#normalizedSubject").text(e.subject),$("#optionalAttendees").html(i(e.optionalAttendees)),$("#requiredAttendees").html(i(e.requiredAttendees)),$("#body").html(e.body)}function i(e){if(e&&e.length>0){for(var t="",n=0;n<e.length;n++)n>0&&(t+="<br />"),t+="<a href='"+(o=e[n]).emailAddress+"'>"+o.displayName+"</a>";return t}var o;return"None"}$(document).ready((function(){document.getElementById("logger").innerHTML+="script loaded\r"})),Office.onReady((function(e){document.getElementById("logger").innerHTML+="office ready: "+JSON.stringify(e)+"\r",$(document).ready((function(){document.getElementById("logger").innerHTML+="document ready\r",e.host===Office.HostType.Outlook&&(document.getElementById("logger").innerHTML+="outlook\r",document.getElementById("submit").onclick=o,Office.context.mailbox.GetIsRead()?function(){document.getElementById("logger").innerHTML+="load read props\r";var e=Office.context.mailbox.item;document.getElementById("logger").innerHTML+=JSON.stringify(e)+"\r",e.body.getAsync("text",{asyncContext:"callback"},(function(t){r(n={start:e.start,end:e.end,location:e.location,subject:e.subject,optionalAttendees:e.optionalAttendees,requiredAttendees:e.requiredAttendees,body:t.value,organizer:e.organizer})}))}():function(){document.getElementById("logger").innerHTML+="load edit props\r";var e=Office.context.mailbox.item;$.when.apply($,$.map(["start","end","location","subject","optionalAttendees","requiredAttendees"],(function(t){var o=$.Deferred();return e[t].getAsync((function(e){e.status===Office.AsyncResultStatus.Succeeded?(n[t]=e.value,document.getElementById("logger").innerHTML+=t+": "+n[t]):document.getElementById("logger").innerHTML+=e.error,o.resolve()})),o.promise()}))).then((function(){e.body.getAsync("text",{asyncContext:"callback"},(function(e){n.body=e.value,n.organizer=Office.context.mailbox.userProfile,r(n)}))}))}())}))}))}});
//# sourceMappingURL=taskpane.js.map